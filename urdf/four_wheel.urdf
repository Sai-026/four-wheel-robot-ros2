<?xml version="1.0"?>
<robot name="four_wheel">

  <link name="base_link">
  </link>
  
    <joint name="chassis_joint" type="fixed">
    <parent link="base_link"/>
    <child link="chassis_link"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <link name="chassis_link">
    <inertial>
      <origin
        xyz="5.8348E-05 1.9882E-18 -0.050103"
        rpy="0 0 0" />
      <mass
        value="3.5437" />
      <inertia
        ixx="0.0093215"
        ixy="1.2246E-18"
        ixz="-5.1617E-07"
        iyy="0.01954"
        iyz="2.5956E-19"
        izz="0.022946" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/chassis_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/chassis_link.STL" />
      </geometry>
    </collision>
  </link>
  <link
    name="lidar_link">
    <inertial>
      <origin
        xyz="-3.4694E-18 9.6911E-19 -0.012"
        rpy="0 0 0" />
      <mass
        value="0.092363" />
      <inertia
        ixx="3.272E-05"
        ixy="-4.3201E-21"
        ixz="-1.6739E-21"
        iyy="3.272E-05"
        iyz="-4.101E-21"
        izz="5.6572E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/lidar_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/lidar_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="lidar_joint"
    type="fixed">
    <origin
      xyz="-0.011194421392866 0 0.024"
      rpy="0 0 0" />
    <parent
      link="chassis_link" />
    <child
      link="lidar_link" />
    <axis
      xyz="0 0 0" />
  </joint>
  <link
    name="left_bk_link">
    <inertial>
      <origin
        xyz="0 -1.7347E-18 0.015"
        rpy="0 0 0" />
      <mass
        value="0.11545" />
      <inertia
        ixx="4.4017E-05"
        ixy="5.5628E-21"
        ixz="-7.6514E-22"
        iyy="4.4017E-05"
        iyz="-4.1359E-22"
        izz="7.0715E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/left_bk_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/left_bk_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="left_bk_joint"
    type="continuous">
    <origin
      xyz="-0.094944 0.12 -0.085"
      rpy="1.5708 0 0" />
    <parent
      link="chassis_link" />
    <child
      link="left_bk_link" />
    <axis
      xyz="0 0 -1" />
    <limit
      effort="20"
      velocity="20" />
    <dynamics
      damping="0.1"
      friction="0.1" />
  </joint>
  <link
    name="left_ft_link">
    <inertial>
      <origin
        xyz="-6.9389E-17 -3.1225E-17 0.015"
        rpy="0 0 0" />
      <mass
        value="0.11545" />
      <inertia
        ixx="4.4017E-05"
        ixy="3.4509E-22"
        ixz="4.8549E-38"
        iyy="4.4017E-05"
        iyz="-9.7099E-38"
        izz="7.0715E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/left_ft_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/left_ft_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="left_ft_joint"
    type="continuous">
    <origin
      xyz="0.095056 0.12 -0.085"
      rpy="1.5708 0 0" />
    <parent
      link="chassis_link" />
    <child
      link="left_ft_link" />
    <axis
      xyz="0 0 -1" />
    <limit
      effort="20"
      velocity="20" />
    <dynamics
      damping="0.1"
      friction="0.1" />
  </joint>
  <link
    name="right_ft_link">
    <inertial>
      <origin
        xyz="-1.3878E-17 3.4694E-18 -0.015"
        rpy="0 0 0" />
      <mass
        value="0.11545" />
      <inertia
        ixx="4.4017E-05"
        ixy="1.1697E-21"
        ixz="1.5536E-36"
        iyy="4.4017E-05"
        iyz="9.7099E-38"
        izz="7.0715E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/right_ft_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/right_ft_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="right_ft_joint"
    type="continuous">
    <origin
      xyz="0.095056 -0.12 -0.085"
      rpy="1.5708 0 0" />
    <parent
      link="chassis_link" />
    <child
      link="right_ft_link" />
    <axis
      xyz="0 0 -1" />
    <limit
      effort="20"
      velocity="20" />
    <dynamics
      damping="0.1"
      friction="0.1" />
  </joint>
  <link
    name="right_bk_link">
    <inertial>
      <origin
        xyz="5.8348E-05 1.9882E-18 -0.050103"
        rpy="0 0 0" />
      <mass
        value="3.5437" />
      <inertia
        ixx="0.0093215"
        ixy="1.2246E-18"
        ixz="-5.1617E-07"
        iyy="0.01954"
        iyz="2.5956E-19"
        izz="0.022946" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/right_bk_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find four_wheel)/meshes/right_bk_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="right_bk_joint"
    type="continuous">
    <origin
      xyz="-0.094944 -0.12 -0.085"
      rpy="1.5708 0 0" />
    <parent
      link="chassis_link" />
    <child
      link="right_bk_link" />
    <axis
      xyz="0 0 -1" />
    <dynamics
      damping="0.1"
      friction="0.1" />
  </joint>

<gazebo>
    <plugin name="differential_drive_controller" filename="libgazebo_ros_diff_drive.so">
        
        <left_joint>left_bk_joint</left_joint>
        <right_joint>right_bk_joint</right_joint>
        
        <wheel_separation>0.24</wheel_separation>
        <wheel_diameter>0.075</wheel_diameter>
        
        <max_wheel_torque>20</max_wheel_torque>
        <max_wheel_acceleration>1.0</max_wheel_acceleration>
        
        <command_topic>cmd_vel</command_topic>
        <odometry_topic>odom</odometry_topic>
        
        <odometry_frame>odom</odometry_frame>
        <robot_base_frame>base_link</robot_base_frame>
        
        <publish_odom>true</publish_odom>
        <publish_odom_tf>true</publish_odom_tf>
        <publish_wheel_tf>false</publish_wheel_tf>
        
        <update_rate>50</update_rate>
    </plugin>
</gazebo>

<!-- Chassis Material and Friction -->
<gazebo reference="chassis_link">
    <material>Gazebo/Red</material>
    <mu1>0.1</mu1>
    <mu2>0.1</mu2>
</gazebo>

<!-- Right Front Wheel Properties -->
<gazebo reference="right_ft_wheel_link">
    <material>Gazebo/Black</material>
    <mu1>1.0</mu1>
    <mu2>1.0</mu2>
    <kp>1000000.0</kp>
    <kd>100.0</kd>
    <minDepth>0.001</minDepth>
    <maxVel>1.0</maxVel>
</gazebo>

<!-- Right Back Wheel Properties -->
<gazebo reference="right_bk_wheel_link">
    <material>Gazebo/Black</material>
    <mu1>1.0</mu1>
    <mu2>1.0</mu2>
    <kp>1000000.0</kp>
    <kd>100.0</kd>
    <minDepth>0.001</minDepth>
    <maxVel>1.0</maxVel>
</gazebo>

<!-- Left Back Wheel Properties -->
<gazebo reference="left_bk_wheel_link">
    <material>Gazebo/Black</material>
    <mu1>1.0</mu1>
    <mu2>1.0</mu2>
    <kp>1000000.0</kp>
    <kd>100.0</kd>
    <minDepth>0.001</minDepth>
    <maxVel>1.0</maxVel>
</gazebo>

<!-- Left Front Wheel Properties -->
<gazebo reference="left_ft_wheel_link">
    <material>Gazebo/Black</material>
    <mu1>1.0</mu1>
    <mu2>1.0</mu2>
    <kp>1000000.0</kp>
    <kd>100.0</kd>
    <minDepth>0.001</minDepth>
    <maxVel>1.0</maxVel>
</gazebo>

<!-- Lidar Material -->
<gazebo reference="lidar_link">
    <material>Gazebo/White</material>
</gazebo>

<!-- Lidar Sensor -->
<gazebo reference="lidar_link">
    <sensor type="ray" name="lidar_sensor">
        <pose>0 0 0 0 0 0</pose>
        <visualize>true</visualize>
        <update_rate>10</update_rate>
        <ray>
            <scan>
                <horizontal>
                    <samples>360</samples>
                    <resolution>1</resolution>
                    <min_angle>-3.14159</min_angle>
                    <max_angle>3.14159</max_angle>
                </horizontal>
            </scan>
            <range>
                <min>0.12</min>
                <max>10.0</max>
                <resolution>0.01</resolution>
            </range>
            <noise>
                <type>gaussian</type>
                <mean>0.0</mean>
                <stddev>0.01</stddev>
            </noise>
        </ray>
        <plugin name="gazebo_ros_lidar_controller" filename="libgazebo_ros_ray_sensor.so">
            <output_type>sensor_msgs/LaserScan</output_type>
            <frame_name>lidar_link</frame_name>
            <topic_name>/scan</topic_name>
        </plugin>
    </sensor>
</gazebo>

<!-- Joint State Publisher -->
<gazebo>
    <plugin name="gazebo_ros_joint_state_publisher" filename="libgazebo_ros_joint_state_publisher.so">
        <update_rate>20</update_rate>
        <joint_name>left_ft_joint</joint_name>
        <joint_name>left_bk_joint</joint_name>
        <joint_name>right_ft_joint</joint_name>
        <joint_name>right_bk_joint</joint_name>
        <joint_name>lidar_joint</joint_name>
    </plugin>
</gazebo>

</robot>
